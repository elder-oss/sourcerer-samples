CREATE TABLE events (
  stream_id VARCHAR(128) NOT NULL,
  category VARCHAR(32) NOT NULL,
  shard INT NOT NULL,
  timestamp TIMESTAMP(6) NOT NULL DEFAULT 0,
  transaction_seq_nr INT NOT NULL,
  event_id VARCHAR(36) NOT NULL,
  event_type VARCHAR(64) NOT NULL,
  data TEXT NOT NULL,
  metadata TEXT NOT NULL,
  PRIMARY KEY (stream_id, category, timestamp, transaction_seq_nr)
);

CREATE UNIQUE INDEX category_idx ON events (
  category,
  shard,
  timestamp,
  stream_id,
  transaction_seq_nr
);

# For our manual timestamp claim logic
CREATE INDEX timestamp_idx ON events (
  timestamp
);
